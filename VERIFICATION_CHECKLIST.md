# DockLambda 验收清单

## 📋 编译和运行验证

### ✅ 基础编译测试
- [ ] **项目可编译**: `xcodebuild -project DockLambda.xcodeproj -scheme DockLambda build`
- [ ] **无编译警告**: Swift 5.9 兼容性检查
- [ ] **macOS 13+ 运行**: 在目标系统版本上启动无崩溃
- [ ] **签名配置**: "Sign to Run Locally" 或开发者证书

### ✅ 应用启动验证
- [ ] **应用启动成功**: 双击或 `open DockLambda.app` 正常启动
- [ ] **LSUIElement 生效**: 应用不在 Dock 显示图标，不在 Cmd+Tab 列表
- [ ] **菜单栏图标显示**: λ 图标出现在系统菜单栏
- [ ] **宠物窗口显示**: 透明窗口在靠近 Dock 位置出现

## 🐾 宠物窗口验证

### ✅ 窗口属性测试
- [ ] **透明背景**: 窗口背景完全透明，无边框
- [ ] **浮动层级**: 在桌面之上，普通应用窗口之下
- [ ] **跨桌面显示**: 在所有 Spaces/Mission Control 桌面可见
- [ ] **鼠标交互**: 默认可点击，不穿透

### ✅ Dock 定位测试
- [ ] **底部 Dock**: 宠物出现在屏幕右下角，距边缘 8-16pt
- [ ] **左侧 Dock**: 移动 Dock 到左侧，宠物自动移至左下角
- [ ] **右侧 Dock**: 移动 Dock 到右侧，宠物自动移至右下角
- [ ] **自动重新定位**: Dock 位置改变时 3-5 秒内自动调整

## 🎭 交互功能验证

### ✅ 基础交互测试
- [ ] **单击喂食**: 点击宠物触发 eat 动画
- [ ] **双击跳舞**: 双击宠物触发 dance 动画 2-3 秒
- [ ] **文件拖拽**: 拖拽文件到宠物触发 wiggle/joy 动画
- [ ] **Option 拖动**: 按住 Option 键可拖动宠物到自定义位置

### ✅ 状态机测试
- [ ] **idle 状态**: 默认状态，循环播放 idle 动画
- [ ] **状态切换**: eat/dance 完成后自动返回 idle
- [ ] **睡眠状态**: 空闲 10-30 秒随机进入 sleep 状态
- [ ] **唤醒交互**: 点击睡眠状态宠物立即唤醒

## 📱 菜单栏功能验证

### ✅ 菜单项测试
- [ ] **Toggle Click-Through**: 切换后宠物变为鼠标穿透/恢复交互
- [ ] **Lock Position**: 启用后 Option+拖动失效
- [ ] **Reset Position**: 重置到 Dock 边缘默认位置
- [ ] **Show/Hide Pet**: 切换宠物窗口显示/隐藏
- [ ] **Quit**: 完全退出应用

### ✅ 开机自启测试
- [ ] **Start at Login 开启**: 菜单项勾选，系统重启后自动启动
- [ ] **Start at Login 关闭**: 取消勾选，重启后不自动启动
- [ ] **权限提示**: 首次启用可能需要系统设置手动批准
- [ ] **SMAppService 正常**: macOS 13+ 新 API 工作正常

## 🎨 资源和动画验证

### ✅ 精灵资源测试
- [ ] **占位符生成**: 无精灵资源时自动生成彩色占位符
- [ ] **占位符动画**: 占位符有基础动画效果（缩放/颜色变化）
- [ ] **资源加载**: 放入真实精灵图片后正确加载和播放
- [ ] **缓存机制**: 重复状态切换无明显加载延迟

### ✅ 动画性能测试
- [ ] **流畅播放**: 所有动画 60fps 流畅播放，无卡顿
- [ ] **内存稳定**: 长时间运行内存使用稳定，无泄漏
- [ ] **CPU 占用**: 正常情况下 CPU 占用 < 5%
- [ ] **电量影响**: 对笔记本电池续航影响微小

## 💻 系统集成验证

### ✅ CPU 监控测试
- [ ] **CPU 读取**: 每 10 秒成功读取系统 CPU 使用率
- [ ] **回退处理**: 权限不足时使用合理的模拟值
- [ ] **频率调节**: 高 CPU 使用时宠物动画更频繁
- [ ] **UI 无阻塞**: CPU 监控在后台运行，不阻塞界面

### ✅ 多屏支持测试
- [ ] **主屏定位**: 默认跟随主显示器的 Dock
- [ ] **屏幕变化**: 显示器配置改变时正确重新定位
- [ ] **分辨率适配**: 不同分辨率和缩放下正确显示
- [ ] **扩展屏幕**: 多显示器环境下稳定工作

## 🛠️ 健壮性验证

### ✅ 异常处理测试
- [ ] **权限限制**: Dock 偏好读取失败时优雅降级
- [ ] **文件缺失**: 关键资源文件缺失时不崩溃
- [ ] **内存压力**: 系统内存不足时正常运行
- [ ] **网络断开**: 无网络环境下正常工作（本应用不需网络）

### ✅ 边界情况测试
- [ ] **极端 CPU**: CPU 使用率 100% 时应用响应正常
- [ ] **快速点击**: 连续快速点击不导致状态混乱
- [ ] **大量文件拖拽**: 同时拖拽多个大文件不卡死
- [ ] **长时间运行**: 24 小时以上运行稳定性

## 📝 用户体验验证

### ✅ 直观性测试
- [ ] **一见即懂**: 普通用户无需说明即可理解基本操作
- [ ] **视觉反馈**: 每个交互都有明确的视觉反应
- [ ] **状态清晰**: 当前模式（穿透/交互）状态易于识别
- [ ] **错误恢复**: 意外操作后易于恢复到正常状态

### ✅ 可用性测试
- [ ] **响应速度**: 所有交互响应时间 < 100ms
- [ ] **学习成本**: 5 分钟内掌握所有基本功能
- [ ] **记忆负担**: 设置在重启后正确保持
- [ ] **操作一致**: 相似操作在不同情况下行为一致

## 🔍 最终验收状态

### 📊 测试结果汇总

| 测试类别 | 通过率 | 状态 | 备注 |
|---------|--------|------|------|
| 编译和运行 | __/4 | ⏳ | 待测试 |
| 宠物窗口 | __/8 | ⏳ | 待测试 |
| 交互功能 | __/8 | ⏳ | 待测试 |
| 菜单栏功能 | __/9 | ⏳ | 待测试 |
| 资源和动画 | __/8 | ⏳ | 待测试 |
| 系统集成 | __/8 | ⏳ | 待测试 |
| 健壮性 | __/8 | ⏳ | 待测试 |
| 用户体验 | __/8 | ⏳ | 待测试 |

### 🎯 关键验收标准

**🚀 发布就绪条件 (必须全部满足):**
- [ ] 编译和运行测试 100% 通过
- [ ] 宠物窗口测试 >= 75% 通过
- [ ] 交互功能测试 >= 90% 通过
- [ ] 菜单栏功能测试 >= 85% 通过
- [ ] 无关键崩溃或数据丢失问题

**⚠️ 已知限制 (可接受):**
- [ ] 开发者签名下 Start at Login 可能需要手动批准
- [ ] CPU 监控在受限环境下使用模拟数据
- [ ] 多屏环境下仅支持主屏 Dock 跟随
- [ ] 精灵资源缺失时使用占位符（功能正常）

### 📋 测试人员签名

- **开发测试**: [ ] 通过 __________ (签名/日期)
- **功能测试**: [ ] 通过 __________ (签名/日期) 
- **用户验收**: [ ] 通过 __________ (签名/日期)
- **最终验收**: [ ] 通过 __________ (签名/日期)

---

**📌 测试指南:**
1. 按顺序执行各类别测试
2. 每项测试标记 ✅ (通过) 或 ❌ (失败)
3. 记录失败项的具体现象和重现步骤
4. 重大问题需要修复后重新测试
5. 最终通过率达标后可准备发布

**🏆 验收完成标准:** 总通过率 >= 85% 且无关键功能失效